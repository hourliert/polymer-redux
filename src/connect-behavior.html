<link rel="import" href="./redux.html">
<link rel="import" href="./provider.html">

<script>

	/** @polymerBehavior */
 	Polymer.ReduxConnectBehavior = function(mapStateToProps) {
 		return {
	 		properties: {
	 			store: {
	 				type: Object
	 			},

	 			state: {
	 				type: Object
	 			}
	 		},

	 		created: function () {
	 			this.async(() => {
	 				const provider = this.create('redux-provider');
	 				const store = this.store = provider.store;

	 				store.subscribe(this._handleNewState.bind(this));

	 				this._computeStateProps(store);
	 			}, 1);
	 		},

	 		_handleNewState: function() {
	 			console.log(this.store.getState());
	 		},

	 		_computeStateProps(store, props) {
  			const state = store.getState();
		    const stateProps = mapStateToProps(state, props);

		    return stateProps;
		  }
	 	};
 	};

</script>